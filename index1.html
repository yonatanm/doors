<!DOCTYPE html>
<html>
<head>
<title>Canvas Door</title>
<style>
  body { margin: 0; overflow: hidden; background-color: #f0f0f0; }
  canvas { border: 1px solid black; }
</style>
</head>
<body>

<canvas id="doorCanvas" width="800" height="300"></canvas>

<script>
  const canvas = document.getElementById('doorCanvas');
  const ctx = canvas.getContext('2d');

  // --- Draw Flower --- (Fixed position)
  function drawFlower(x, y) {
    // Center (yellow)
    ctx.fillStyle = 'yellow';
    ctx.beginPath();
    ctx.arc(x, y, 15, 0, Math.PI * 2);
    ctx.fill();

    // Petals (red)
    ctx.fillStyle = 'red';
    const petalLength = 30;
    const petalWidth = 10;
    for (let i = 0; i < 6; i++) {
      ctx.save();
      ctx.translate(x, y);
      ctx.rotate((Math.PI / 3) * i);
      ctx.beginPath();
      ctx.ellipse(0, -petalLength / 2 - 10, petalWidth, petalLength, 0, 0, Math.PI * 2);
      ctx.fill();
      ctx.restore();
    }
  }

  const flowerX = canvas.width / 2; // Centered flower in the wider canvas
  const flowerY = canvas.height / 2;

  // --- Door Properties ---
  const scale = 5; // 5 pixels per cm
  const doorWidthCm = 40;
  const doorHeightCm = 20;
  const borderWidthCm = 2;

  const doorWidthPx = doorWidthCm * scale; // 200px
  const doorHeightPx = doorHeightCm * scale; // 100px
  const borderWidthPx = borderWidthCm * scale; // 10px

  // --- Door State ---
  let doorX = (canvas.width - doorWidthPx) / 2; // Initial X position (centered)
  const doorY = (canvas.height - doorHeightPx) / 2; // Fixed Y position (centered)
  let isDragging = false;
  let dragOffsetX = 0;

  // --- Draw Door ---
  function drawDoor(x, y) {
    // Draw the border
    ctx.strokeStyle = 'black';
    ctx.lineWidth = borderWidthPx;
    // strokeRect draws the border *centered* on the path.
    // To make the *outer* dimensions match doorWidthPx x doorHeightPx,
    // we draw the rectangle slightly inset by half the border width.
    ctx.strokeRect(
      x + borderWidthPx / 2,
      y + borderWidthPx / 2,
      doorWidthPx - borderWidthPx,
      doorHeightPx - borderWidthPx
    );
    // Transparent inside (default)
  }

  // --- Redraw Canvas ---
  function redraw() {
    // Clear canvas
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Draw flower (always in the same spot)
    drawFlower(flowerX, flowerY);

    // Draw door (at current position)
    drawDoor(doorX, doorY);
  }

  // --- Mouse Event Handlers ---
  canvas.addEventListener('mousedown', (e) => {
    const mouseX = e.offsetX;
    const mouseY = e.offsetY;

    // Check if click is within the door bounds
    if (mouseX >= doorX && mouseX <= doorX + doorWidthPx &&
        mouseY >= doorY && mouseY <= doorY + doorHeightPx) {
      isDragging = true;
      dragOffsetX = mouseX - doorX;
    }
  });

  canvas.addEventListener('mousemove', (e) => {
    if (!isDragging) return;

    const mouseX = e.offsetX;
    // Update doorX based on mouse movement, keeping it within canvas bounds
    let newDoorX = mouseX - dragOffsetX;
    newDoorX = Math.max(0, newDoorX); // Prevent moving past left edge
    newDoorX = Math.min(canvas.width - doorWidthPx, newDoorX); // Prevent moving past right edge
    doorX = newDoorX;

    redraw();
  });

  canvas.addEventListener('mouseup', () => {
    if (isDragging) {
       isDragging = false;
       redraw(); // Redraw in final position
    }
  });

  canvas.addEventListener('mouseleave', () => {
    if (isDragging) {
       isDragging = false;
       redraw(); // Redraw in final position if mouse leaves while dragging
    }
  });

  // Initial Draw
  redraw();

</script>

</body>
</html>
